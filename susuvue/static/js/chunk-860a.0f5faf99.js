(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-860a"],{JWCd:function(n,e,t){"use strict";var o=t("mN3r");t.n(o).a},"Ns/3":function(n,e,t){(n.exports=t("I1BE")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},Yfch:function(n,e,t){"use strict";function o(n){return/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(n)}t.d(e,"a",function(){return o})},mN3r:function(n,e,t){var o=t("Ns/3");"string"==typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);(0,t("SZ7m").default)("377d63de",o,!0,{})},q4Ke:function(n,e,t){"use strict";t.r(e);var o=t("Q2AE"),i=t("Yfch"),a=t("wk8/"),s=t("t3Un");var r={props:{email:{type:String,required:!0}},data:function(){var n=this;return{loading:!1,dialog:!1,title:"修改邮箱",form:{pass:"",email:"",code:""},user:{email:"",password:""},codeLoading:!1,codeData:{type:"email",value:""},buttonName:"获取验证码",isDisabled:!1,time:60,rules:{pass:[{required:!0,message:"当前密码不能为空",trigger:"blur"}],email:[{required:!0,validator:function(e,t,o){""===t||null===t?o(new Error("新邮箱不能为空")):t===n.email?o(new Error("新邮箱不能与旧邮箱相同")):Object(i.a)(t)?o():o(new Error("邮箱格式错误"))},trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},sendCode:function(){var n=this;if(this.form.email&&this.form.email!==this.email){this.codeLoading=!0,this.buttonName="验证码发送中",this.codeData.value=this.form.email;var e=this;(function(n){return Object(s.a)({url:"api/code/resetEmail",method:"post",data:n})})(this.codeData).then(function(t){n.$message({showClose:!0,message:"发送成功，验证码有效期5分钟",type:"success"}),n.codeLoading=!1,n.isDisabled=!0,n.buttonName=n.time--+"秒后重新发送",n.timer=window.setInterval(function(){e.buttonName=e.time+"秒后重新发送",--e.time,e.time<0&&(e.buttonName="重新发送",e.time=60,e.isDisabled=!1,window.clearInterval(e.timer))},1e3)}).catch(function(e){n.resetForm(),n.codeLoading=!1,console.log(e.response.data.message)})}},doSubmit:function(){var n=this;this.$refs.form.validate(function(e){if(!e)return!1;n.loading=!0,n.user={email:n.form.email,password:n.form.pass},Object(a.d)(n.form.code,n.user).then(function(e){n.loading=!1,n.resetForm(),n.$notify({title:"邮箱修改成功",type:"success",duration:1500}),o.a.dispatch("GetInfo").then(function(){})}).catch(function(e){n.loading=!1,console.log(e.response.data.message)})})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),window.clearInterval(this.timer),this.time=60,this.buttonName="获取验证码",this.isDisabled=!1,this.form={pass:"",email:"",code:""}}}},l=(t("JWCd"),t("KHd+")),u=Object(l.a)(r,function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticStyle:{display:"inline-block"}},[t("el-dialog",{attrs:{visible:n.dialog,"close-on-click-modal":!1,title:n.title,"append-to-body":"",width:"475px"},on:{"update:visible":function(e){n.dialog=e},close:n.cancel}},[t("el-form",{ref:"form",attrs:{model:n.form,rules:n.rules,size:"small","label-width":"88px"}},[t("el-form-item",{attrs:{label:"新邮箱",prop:"email"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{"auto-complete":"on"},model:{value:n.form.email,callback:function(e){n.$set(n.form,"email",e)},expression:"form.email"}}),n._v(" "),t("el-button",{attrs:{loading:n.codeLoading,disabled:n.isDisabled,size:"small"},on:{click:n.sendCode}},[n._v(n._s(n.buttonName))])],1),n._v(" "),t("el-form-item",{attrs:{label:"验证码",prop:"code"}},[t("el-input",{staticStyle:{width:"320px"},model:{value:n.form.code,callback:function(e){n.$set(n.form,"code",e)},expression:"form.code"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"当前密码",prop:"pass"}},[t("el-input",{staticStyle:{width:"320px"},attrs:{type:"password"},model:{value:n.form.pass,callback:function(e){n.$set(n.form,"pass",e)},expression:"form.pass"}})],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"text"},on:{click:n.cancel}},[n._v("取消")]),n._v(" "),t("el-button",{attrs:{loading:n.loading,type:"primary"},on:{click:n.doSubmit}},[n._v("确认")])],1)],1)],1)},[],!1,null,"2388c3d7",null);u.options.__file="updateEmail.vue";e.default=u.exports},"wk8/":function(n,e,t){"use strict";t.d(e,"a",function(){return i}),t.d(e,"b",function(){return a}),t.d(e,"c",function(){return s}),t.d(e,"e",function(){return r}),t.d(e,"d",function(){return l});var o=t("t3Un");function i(n){return Object(o.a)({url:"/vue/api/users",method:"post",data:n})}function a(n){return Object(o.a)({url:"/vue/api/users/"+n,method:"delete"})}function s(n){return Object(o.a)({url:"/vue/api/users",method:"put",data:n})}function r(n){var e={oldPass:n.oldPass,newPass:n.newPass};return Object(o.a)({url:"/vue/api/users/updatePass/",method:"post",data:e})}function l(n,e){return Object(o.a)({url:"/vue/api/users/updateEmail/"+n,method:"post",data:e})}}}]);